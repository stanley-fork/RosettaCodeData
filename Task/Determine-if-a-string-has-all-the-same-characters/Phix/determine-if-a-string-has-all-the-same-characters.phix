with javascript_semantics
procedure samechar(sequence s)
    string msg = "all characters are the same"
    integer l = length(s)
    if l>=2 then
        integer ch = s[1]
        for i=2 to l do
            integer si = s[i]
            if si!=ch then
                string su = utf32_to_utf8({si})
                msg = sprintf(`first different character "%s"(#%02x) at position %d`,{su,si,i})
                exit
            end if
        end for
    end if
    printf(1,"\"%s\" (length %d): %s\n",{utf32_to_utf8(s),l,msg})
end procedure

constant tests = {"","   ","2","333",".55","tttTTT","4444 444k",
                  utf8_to_utf32("ğŸ¶ğŸ¶ğŸºğŸ¶"),utf8_to_utf32("ğŸ„ğŸ„ğŸ„ğŸ„")}
for i=1 to length(tests) do samechar(tests[i]) end for
